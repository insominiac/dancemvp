"use strict";(()=>{var e={};e.id=30,e.ids=[30],e.modules={3524:e=>{e.exports=require("@prisma/client")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2801:(e,t,n)=>{n.r(t),n.d(t,{originalPathname:()=>g,patchFetch:()=>h,requestAsyncStorage:()=>l,routeModule:()=>p,serverHooks:()=>m,staticGenerationAsyncStorage:()=>v});var a={};n.r(a),n.d(a,{GET:()=>d,POST:()=>c});var r=n(9303),s=n(8716),i=n(670),o=n(7070);let u=new(n(3524)).PrismaClient;async function d(e){try{let t=e.nextUrl.searchParams,n=parseInt(t.get("page")||"1"),a=parseInt(t.get("limit")||"10"),r=t.get("search")||"",s=t.get("status")||"",i=t.get("venueId")||"",d=(n-1)*a,c={AND:[r?{OR:[{title:{contains:r,mode:"insensitive"}},{description:{contains:r,mode:"insensitive"}}]}:{},s?{status:s}:{},i?{venueId:i}:{}]},[p,l]=await Promise.all([u.event.findMany({where:c,skip:d,take:a,orderBy:{startDate:"desc"},include:{venue:!0,organizer:!0,eventStyles:{include:{style:!0}},_count:{select:{bookings:!0}}}}),u.event.count({where:c})]);return o.NextResponse.json({events:p,pagination:{total:l,page:n,limit:a,totalPages:Math.ceil(l/a)}})}catch(e){return console.error("Error fetching events:",e),o.NextResponse.json({error:"Failed to fetch events"},{status:500})}}async function c(e){try{let{title:t,description:n,eventType:a,startDate:r,endDate:s,startTime:i,endTime:d,venueId:c,price:p,maxAttendees:l,imageUrl:v,organizerUserId:m,status:g,isFeatured:h,styleIds:x}=await e.json(),y=await u.event.create({data:{title:t,description:n,eventType:a,startDate:new Date(r),endDate:new Date(s),startTime:i,endTime:d,venueId:c,price:parseFloat(p),maxAttendees:parseInt(l),currentAttendees:0,imageUrl:v,organizerUserId:m,status:g||"DRAFT",isFeatured:h||!1}});x&&x.length>0&&await u.eventStyle.createMany({data:x.map(e=>({eventId:y.id,styleId:e}))});let f=await u.event.findUnique({where:{id:y.id},include:{venue:!0,organizer:!0,eventStyles:{include:{style:!0}}}});return o.NextResponse.json({message:"Event created successfully",event:f},{status:201})}catch(e){return console.error("Error creating event:",e),o.NextResponse.json({error:"Failed to create event"},{status:500})}}let p=new r.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/admin/events/route",pathname:"/api/admin/events",filename:"route",bundlePath:"app/api/admin/events/route"},resolvedPagePath:"/Users/hemantd/DL/dance-platform/app/api/admin/events/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:l,staticGenerationAsyncStorage:v,serverHooks:m}=p,g="/api/admin/events/route";function h(){return(0,i.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:v})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var n=e=>t(t.s=e),a=t.X(0,[948,972],()=>n(2801));module.exports=a})();